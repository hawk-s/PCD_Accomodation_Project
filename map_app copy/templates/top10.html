<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top 10 Visited Regions</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
    <style>
        #table-container {
            margin: 20px auto;
            padding: 10px;
            width: 80%;
            max-width: 800px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Top 10 Visited Regions</h1>

    <div class="controls">
        <label for="dataset">Choose Dataset:</label>
        <select id="dataset">
            <option value="stays">Stays</option>
            <option value="length_of_stay">Length of Stay</option>
            <option value="nights_spent">Nights Spent</option>
        </select>

        <label for="category">Choose Category:</label>
        <select id="category">
            <option value="DOM">Domestic</option>
            <option value="FOR">Foreign</option>
            <option value="TOTAL">Total</option>
        </select>

        <label for="year">Choose Year:</label>
        <select id="year">
            <option value="2018">2018</option>
            <option value="2019">2019</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
            <option value="2022">2022</option>
            <option value="2023">2023</option>
        </select>

        <label for="month">Choose Month:</label>
        <select id="month">
            <option value="January">January</option>
            <option value="February">February</option>
            <!-- Add more months here -->
        </select>

        <button onclick="loadTop10()">Load Top 10</button>
        <button onclick="loadAll()">Load All</button>
    </div>

    <div id="table-container">
        <table id="top10-table">
            <thead>
                <tr>
                    <th>Region</th>
                    <th>Bookings</th>
                </tr>
            </thead>
            <tbody>
                <!-- Rows will be inserted dynamically -->
            </tbody>
        </table>
    </div>

    <script>
        function loadTop10() {
            const metric = document.getElementById('dataset').value;
            const year = document.getElementById('year').value;
            const month = document.getElementById('month').value;
            const category = document.getElementById('category').value;

            fetch(`/top10/data?metric=${metric}&year=${year}&month=${month}&category=${category}`)
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('top10-table').getElementsByTagName('tbody')[0];
                    tbody.innerHTML = ''; // Clear previous data
                    data.forEach(region => {
                        const row = document.createElement('tr');
                        row.innerHTML = `<td>${region.GEO}</td><td>${region.bookings}</td>`;
                        tbody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error("Error loading top 10 data:", error);
                });
        }

        function loadAll() {
            const metric = document.getElementById('dataset').value;
            const year = document.getElementById('year').value;
            const month = document.getElementById('month').value;
            const category = document.getElementById('category').value;

            fetch(`/top10/data/all?metric=${metric}&year=${year}&month=${month}&category=${category}`)
                .then(response => response.json())
                .then(data => {
                    const tbody = document.getElementById('top10-table').getElementsByTagName('tbody')[0];
                    tbody.innerHTML = ''; // Clear previous data
                    data.forEach(region => {
                        const row = document.createElement('tr');
                        row.innerHTML = `<td>${region.GEO}</td><td>${region.bookings}</td>`;
                        tbody.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error("Error loading all data:", error);
                });
        }
    </script>
</body>
</html>
